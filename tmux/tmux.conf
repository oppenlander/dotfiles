################################################################################
# SETTINGS
################################################################################

#set -g default-terminal "screen-256color"

#set-option -g default-shell "/usr/bin/fish"

# # use vi mode
setw -g mode-keys vi
setw -g xterm-keys on
set -s escape-time 0

# Ensure it's using a proepr base index
set -g base-index 1
set -g pane-base-index 1

# directly expose pane titles
set -g set-titles on
set -g set-titles-string "#T"

setw -g monitor-activity on
set -g visual-activity on

# urgency hints
set -g bell-action any
set -g bell-on-alert on

# only resize shared windows
setw -g aggressive-resize on

# turn off mouse
set -g mode-mouse on
set -g mouse-utf8 off
set -g mouse-resize-pane on
set -g mouse-select-pane on
set -g mouse-select-window on

################################################################################
## PREFIX
################################################################################

unbind C-b
set -g prefix C-Space
# # nested prefix
bind C-Space send-prefix
bind Space send-prefix

################################################################################
## SESSIONS
################################################################################

bind s run "tmux-cords.sh session"

################################################################################
## WINDOWS (panes)
################################################################################

bind r run "tmux-cords.sh resize"

################################################################################
## WINDOWS (panes)
################################################################################

bind w run "tmux-cords.sh window"

################################################################################
## FRAMES (windows)
################################################################################

bind f run "tmux-cords.sh frame"

################################################################################
# NAVIGATING
################################################################################

# Smart pane switching with awareness of vim splits
bind -n C-J run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim(diff)?$|emacs.*$' && tmux send-keys C-J) || tmux select-pane -D"
bind -n C-K run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim(diff)?$|emacs.*$' && tmux send-keys C-K) || tmux select-pane -U"
bind -n C-H run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim(diff)?$|emacs.*$' && tmux send-keys C-H) || tmux select-pane -L"
bind -n C-L run "(tmux display-message -p '#{pane_current_command}' | grep -iqE '(^|\/)vim(diff)?$|emacs.*$' && tmux send-keys C-L) || tmux select-pane -R"
bind -n C-\ run "(tmux display -p '#T' | grep -q ' - VIM$' && tmux send 'C-\\') || tmux select-pane -l || :"

# fallback for weird situations
bind -r Up select-pane -U
bind -r Down select-pane -D
bind -r Left select-pane -L
bind -r Right select-pane -R


################################################################################
# SWAPPING
################################################################################

bind -r S-Down swap-pane -D
bind -r S-Up swap-pane -U
bind -r S-Left swap-pane -U
bind -r S-Right swap-pane -D


################################################################################
## COPY
################################################################################

bind Escape copy-mode
bind P paste-buffer
bind -t vi-copy v begin-selection
bind -t vi-copy i cancel
bind -t vi-copy a cancel
bind -t vi-copy c cancel
bind -t vi-copy C cancel

################################################################################
## MOUSES
################################################################################

# turn mouse on
bind M \
  set -g mode-mouse on \;\
  set -g mouse-resize-pane on \;\
  set -g mouse-select-pane on \;\
  set -g mouse-select-window on \;\
  display 'Mouse: ON'

# turn mouse off
bind m \
  set -g mode-mouse off \;\
  set -g mouse-resize-pane off \;\
  set -g mouse-select-pane off \;\
  set -g mouse-select-window off \;\
  display 'Mouse: OFF'

################################################################################
## PLUGINS

################################################################################

# plugins="~/.tmux/plugins"

# # installed plugins
# set -g @tpm_plugins "\
#   tmux-plugins/tpm \
#   tmux-plugins/tmux-sensible \
#   tmux-plugins/tmux-yank \
#   tmux-plugins/tmux-copycat \
#   tmux-plugins/tmux-open \
# "

# # init TMUX plugin manager.
# run-shell "$plugins/tpm/tpm"

################################################################
# THEME
################################################################

setw -g clock-mode-colour colour117
setw -g mode-attr bold
setw -g mode-fg colour117
setw -g mode-bg colour238
set -g status-bg colour235
set -g status-fg colour248
set -g status-attr dim
set -g status-left '#[fg=colour187,bold]#H'
set -g status-right '#[fg=colour174]#(mpc) #[fg=colour187,bold]%H:%M:%S'
set -g status-right-length 80
setw -g window-status-current-fg colour223
setw -g window-status-current-bg colour237
setw -g window-status-current-attr bold
set -g message-attr bold
set -g message-fg colour117
set -g message-bg colour235